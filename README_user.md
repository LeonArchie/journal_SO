Изменения в релизе v.4.0.0

    Скрипт normalizations.py удален
    Функционал скрипта распределен по другим скриптам
    Добавлен функционал замены уроков по списку замен

    Порядок работы
        Выгрузите расписание из ПО АВЕРС 
        Прведите нормализацию файла расписания
            - Не трогайте строки до первого класса (они будут проверяться при запуске программы)
            - Уберите незначащие строки (строки к которых нет уроков а указано только время)
            - Приведите расписание к формату (РАСПИСАНИЕ КЛАССА - ПУСТАЯ СТРОКА - КЛАСС - ПУСТАЯ СТРОКА)
            - Первый столбец выделите и установить тип ячеек текст
            - Проверьте что номера уроков состоят только из цифр от 1 до 10 (номера уроков второй смены нужно изменить на 1-10)
            - Переименуйте файл в raspisanie.xlsx
            - Положите файл в папку со скриптами 

        Подготовьте справочник кабинетов klass.xlsx
            - Выгрузите справочник из ГИС СО ЕЦП
                Ручных правок как правило не требуется
            - Формат справочника
                Кабинеты
                Наименование школы
                Заголовки
                Далее в первом столбце перечислите наименования кабинетов, в одной ячейке один кабинет

            - Переименуйте файл в klass.xlsx
            - Положите файл в папку со скриптами 
        
        Подготовьте справичник уроков lesson.xlsx
            - Выгрузите справочник из ГИС СО ЕЦП 
                    Ручных правок не требуется

            - Переименуйте файл в lesson.xlsx
            - Положите файл в папку со скриптами  

        Подготовьте справочник групп groups.xlsx
            - Можно составить самостоятельно или частично выгрузить из справчника групп ГИС СО ЕЦП
            - Формат файла
                Заголовки
                Первый столбец      Второй столбец          Третий столбец              Четвертый столбец
                Класс               Предмет                 Учитель                     Группа
        Пример  11А                 Информатика             Иванов И. И.                Группа 1

            - Переименуйте файл в groups.xlsx
            - Положите файл в папку со скриптами 


        ! ВАЖНО !

        ГИС СО ЕЦП Не умеет работать со скобками проследите что в названиях предметов и в группах нет скобок
        Если у Вас в названиях уроков при выгрузке есть скобки то скрипт замен специально для Вас
        Группы нужно отредактировать и привести к формату без скобок

        ! ВАЖНО ! 

        Подготовьте справочник замены zamena.xlsx
            - Формат файла 
                Заголовки
                Первый столбец              Второй столбец
                (Что меняем)                (На что меняем)
        Пример  Алгебра (е)	                Алгебра и начало математического анализа

            - Переименуйте файл в zamena.xlsx
            - Положите файл в папку со скриптами  

        Запустите файл Lider.py
        Будут по очереди запускаться скрипты весь ход исполнения записывается в файл log.log
        В случае обнаружения ошибок в этом файле скрипт запросит разрешение на продолжение работы
        Так же если будут обнаружены файлы ошибок "error.log", "err_groups.log", "chech_groups.log", "final_error.log" 
        скрипт так же будет ждать раррешения на продолжение

        Оприсание исполнения скриптов 
            delete.py
                Удаление временных файлов если они существуют
                Список файлов 
                    "log.log",
                    "error.log",
                    "err_groups.log",
                    "final_error.log",
                    "chech_groups.log",
                    "GIS_schedule.csv",
                    "klass.csv",
                    "lesson.csv",   
                    "raspisanie.csv",
                    "groups.csv",
                    "zamena.csv",
                    "raspisanie.json",
                    "raspisanie_key_added.json",
                    "raspisanie_sinh_time.json",
                    "raspisanie_groups_added.json",
                    "raspisanie_null_lesson_added.json",
                    "raspisanie_sorted_schedule.json",
                    "raspisanie_replace_lessons.json",
                    "raspisanie_cab_updated.json"
            exel_to_csv.py
                Преобразовывает файлы 'raspisanie.xlsx', 'klass.xlsx', 'lesson.xlsx', 'groups.xlsx', 'zamena.xlsx'
                В csv формат в кодировке windows-1251
                На выходе получаем 'raspisanie.csv', 'klass.csv', 'lesson.csv', 'groups.csv', 'zamena.csv'
            
            csv_to_json.py
                Преобразовывает csv файл расписания в json файл для работы программы
                Принимает на вход файл raspisanie.csv
                На выходе отдает файл raspisanie.json


        ! ВАЖНО ! 

            Все json файлы в кодировке utf-8

        ! ВАЖНО !


            FindError.py
                Выполняет проверку на ошибка файла raspisanie.json
                Скрипт проверяет, что наименования уроков и кабинета существуют в ГИС СО ЕЦП
                Скрипт проверяет какие кабинеты и уроки есть в справочниках lesson.csv, klass.csv
                Затем сверяет, что в расписание внесены именно эти уроки и кабинеты
                Если скрипт выявляет отклонения то записывает ошибки в файл error.log

                Ошибки не всегда являются стоп факторм для остановки работы
                Если в будущем эти уроки будут заменены скриптом замены, то ошибки можно игнорировать
                    В будущем релизе будет дополнительная проверка которая уберет эти ошибки

                В противном случае нужно внести исправления

            
            add_key.py
                Технический скрипт, проверяет ключи в файле raspisanie.json 
                Исправляет ошибки ключей если их обнаруживает
                На выходе имеем файл raspisanie_key_added.json

            sinh_time.py
                Технический скрипт
                Добавляет время в уроки по подгруппам
                Входящий файл raspisanie_key_added.json
                На выходе имеем raspisanie_sinh_time.json

            add_groups.py
                Скрипт выполняет привязку групп к урокам которые где они должны быть
                    Входящий файл raspisanie_sinh_time.json
                    Справочник для работы groups.csv
                    На выходе имеем raspisanie_groups_added.json
                Проверка ведется по связке 
                    Класс + Предмет + Учитель
                Если для связки найдено более отдного совпадения, то 
                    На одного учителя будут назначены обе группы
                Если связка только одна, то она привяжется по соответсвующим ключам
                Ошибки дополнительно отбрасываются в err_groups.log

            all_null_lesson.py
                Технический скрипт
                    Нормализует raspisanie_groups_added.json добавляя пустые массивы
                    Там где они необходимы, уравнивая количество массивов в каждом дне недели для класса                        
                    На вызоде имеем raspisanie_null_lesson_added.json

            lesson_sort.py
                Технический скрипт 
                    Сортирует массивы в нутри дня недели 
                    На вход raspisanie_null_lesson_added.json
                    На выходе raspisanie_sorted_schedule.json
                
            update_cab.py
                Технический скрипт
                Проверяет файл raspisanie_sorted_schedule.json
                Добавляет значение Нет кабинет там где они не указаны
                Пустые массивы игнорирует
                На выходе raspisanie_cab_updated.json
                
            check_group.py
                Скрипт проверяет назначение групп 
                если предмет указан в справочнике groups.csv 
                но группы не привязаны записывает ошибка в файл chech_groups.log
                Возомжны ложные срабатывания, например в начально школе урок технология ведет классный руководитель
                для всего класса, соответсвенно группа не указана.
                Такие ошибки можно игнорировать
                
            update_lesson_gis.py
                Скрипт выполняет замену названий уроков с соответсвии с справочником zamena.csv
                На вход принимает файл raspisanie_cab_updated.json
                На выходе имеем файл raspisanie_replace_lessons.json

            Final_check.py
                Скрипт выполняет проверки названий уроков в соответсвии с справочником уроков lesson.csv
                Ошибки отбрасывает в файл final_error.log
                Не рекомендую игнорировать ошибки в данном файле (гарантировано будут ошибки при загрузке)    
            
            json_to_GIS_SO.py
                Скрипт готовит расписание для загрузки в ГИС СО ЕЦП
                Берет файл raspisanie_replace_lessons.json
                На выходе иммем файл GIS_schedule.csv

        Осталось только открыть полученный файл сокопировать все в шаблон от ГИС СО ЕЦП
        Загрузить на сервер
        Вы бесподобны

    Если у Вас возникла какая либо ошибка которую Вы не можете разобрать самостоятельно 
    После исполнения скрипта не изменяйте никаких файлов, заархивируте всю папку со скриптом
    Отправьте архив по адресу levmikhailovish@yandex.ru и/или service@ippetunin.ru
    В теле письма опишите Вашу проблему и мы постараемся помочь в ближайшее время 
